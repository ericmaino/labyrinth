nodes:
  - key: AzureBackbone/outbound
    friendlyName: AzureBackbone
    routes:
      - destination: Internet
  - key: Internet
    routes:
      - destination: publicIp1/endpoint
        constraints:
          destinationIp: 52.250.65.117
          sourceIp: Internet
      - destination: publicIp2/endpoint
        constraints:
          destinationIp: 52.247.250.222
          sourceIp: Internet
  - key: loadBalancer1
    friendlyName: public-lb
    routes:
      - destination: vnet1/inbound
        constraints:
          destinationIp: 52.247.250.222
          destinationPort: '800'
          protocol: Tcp
        override:
          destinationIp: 172.16.0.5
          destinationPort: '8000'
      - destination: UnboundRule
        constraints:
          destinationIp: 52.247.250.222
          destinationPort: '3389'
          protocol: Tcp
  - key: loadBalancer2
    friendlyName: ilb
    routes:
      - destination: vnet1/inbound
        constraints:
          destinationIp: 172.16.0.21
          destinationPort: '3022'
          protocol: Tcp
        override:
          destinationIp: 172.16.0.20
          destinationPort: '22'
      - destination: UnboundRule
        constraints:
          destinationIp: 172.16.0.21
          destinationPort: '4000'
          protocol: Tcp
  - key: nic1/inbound
    friendlyName: vm-001505
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/networkinterfaces/vm-001505
    routes:
      - destination: vm1/inbound
    filters:
      - action: allow
        priority: 300
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '443'
          protocol: TCP
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: AzureLoadBalancer
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
  - key: nic1/outbound
    friendlyName: vm-001505
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/networkinterfaces/vm-001505
    routes:
      - destination: vnet1/outbound
    filters:
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: Internet
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
  - key: nic2/inbound
    friendlyName: vm-lb-016
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/networkinterfaces/vm-lb-016
    routes:
      - destination: vm2/inbound
  - key: nic2/outbound
    friendlyName: vm-lb-016
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/networkinterfaces/vm-lb-016
    routes:
      - destination: vnet1/outbound
  - key: nic3/inbound
    friendlyName: vm-002237
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/networkinterfaces/vm-002237
    routes:
      - destination: vm3/inbound
    filters:
      - action: allow
        priority: 300
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '3389'
          protocol: TCP
      - action: allow
        priority: 320
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '80'
          protocol: TCP
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: AzureLoadBalancer
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
  - key: nic3/outbound
    friendlyName: vm-002237
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/networkinterfaces/vm-002237
    routes:
      - destination: vnet1/outbound
    filters:
      - action: allow
        priority: 65000
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: vnet1
          sourcePort: '*'
          destinationIp: vnet1
          destinationPort: '*'
          protocol: '*'
      - action: allow
        priority: 65001
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: Internet
          destinationPort: '*'
          protocol: '*'
      - action: deny
        priority: 65500
        id: 1
        source: data/azure/resource-graph-1.json
        constraints:
          sourceIp: '*'
          sourcePort: '*'
          destinationIp: '*'
          destinationPort: '*'
          protocol: '*'
  - key: publicIp1/endpoint
    friendlyName: vm-001-ip
    routes:
      - destination: vnet1/router
        override:
          destinationIp: 172.16.0.4
  - key: publicIp1/outbound
    friendlyName: vm-001-ip
    routes:
      - destination: AzureBackbone/outbound
        override:
          sourceIp: 52.250.65.117
  - key: publicIp2/endpoint
    friendlyName: public-lb-ip
    routes:
      - destination: loadBalancer1
  - key: subnet1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/virtualnetworks/x-example-vnet/subnets/default
    friendlyName: default
    routes:
      - destination: nic1/inbound
        constraints:
          destinationIp: 172.16.0.4
      - destination: nic2/inbound
        constraints:
          destinationIp: 172.16.0.5
  - key: subnet2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/virtualnetworks/x-example-vnet/subnets/another
    friendlyName: another
    routes:
      - destination: nic3/inbound
        constraints:
          destinationIp: 172.16.0.20
  - key: UnboundRule
    routes: []
  - key: vm1/inbound
    friendlyName: vm-001
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.compute/virtualmachines/vm-001
    endpoint: true
    routes: []
  - key: vm1/outbound
    friendlyName: vm-001
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.compute/virtualmachines/vm-001
    endpoint: true
    routes:
      - destination: nic1/outbound
        constraints:
          sourceIp: 172.16.0.4
  - key: vm2/inbound
    friendlyName: vm-lb-01
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.compute/virtualmachines/vm-lb-01
    endpoint: true
    routes: []
  - key: vm2/outbound
    friendlyName: vm-lb-01
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.compute/virtualmachines/vm-lb-01
    endpoint: true
    routes:
      - destination: nic2/outbound
        constraints:
          sourceIp: 172.16.0.5
  - key: vm3/inbound
    friendlyName: vm-002
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.compute/virtualmachines/vm-002
    endpoint: true
    routes: []
  - key: vm3/outbound
    friendlyName: vm-002
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.compute/virtualmachines/vm-002
    endpoint: true
    routes:
      - destination: nic3/outbound
        constraints:
          sourceIp: 172.16.0.20
  - key: vnet1/inbound
    friendlyName: x-example-vnet
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/virtualnetworks/x-example-vnet
    routes:
      - destination: subnet1/inbound
        constraints:
          destinationIp: 172.16.0.0/28
      - destination: subnet2/inbound
        constraints:
          destinationIp: 172.16.0.16/28
  - key: vnet1/outbound
    friendlyName: x-example-vnet
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/virtualnetworks/x-example-vnet
    routes:
      - destination: vnet1/router
        constraints:
          destinationIp: 172.16.0.0/24
      - destination: publicIp1/outbound
        constraints:
          sourceIp: 172.16.0.4
      - destination: AzureBackbone/outbound
  - key: vnet1/router
    friendlyName: x-example-vnet
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/x-vnet-examples/providers/microsoft.network/virtualnetworks/x-example-vnet
    range:
      sourceIp: 172.16.0.0/24
    routes:
      - destination: loadBalancer2
        constraints:
          destinationIp: 172.16.0.21
      - destination: loadBalancer1
        constraints:
          destinationIp: 52.247.250.222
      - destination: vnet1/inbound
        constraints:
          destinationIp: 172.16.0.0/24
symbols:
  - dimension: ip
    symbol: AzureLoadBalancer
    range: 168.63.129.16
  - dimension: protocol
    symbol: Udp
    range: udp
  - dimension: protocol
    symbol: UDP
    range: udp
  - dimension: protocol
    symbol: Tcp
    range: tcp
  - dimension: protocol
    symbol: TCP
    range: tcp
  - dimension: ip
    symbol: vnet1
    range: 172.16.0.0/24
  - dimension: ip
    symbol: Internet
    range: >-
      1.0.0.0/8,2.0.0.0/7,4.0.0.0/6,8.0.0.0/7,11.0.0.0/8,12.0.0.0/8,13.0.0.0/10,13.64.0.0/11,13.104.0.0/13,13.112.0.0/12,13.128.0.0/9,14.0.0.0/7,16.0.0.0/6,20.0.0.0/9,20.129.0.0/16,20.131.0.0/16,20.132.0.0/14,20.136.0.0/13,20.148.0.0/14,20.152.0.0/13,20.160.0.0/12,20.184.0.0/13,20.192.0.0/10,23.0.0.0/8,24.0.0.0/8,25.16.0.0/13,25.24.0.0/14,25.32.0.0/16,25.33.0.0/18,25.33.64.0/20,25.33.96.0/19,25.33.128.0/17,25.34.0.0/15,25.36.0.0/14,25.40.0.0/16,25.41.0.0/23,25.41.2.0/24,25.41.3.128/25,25.41.4.0/22,25.41.8.0/21,25.41.16.0/20,25.41.32.0/19,25.41.64.0/18,25.41.128.0/17,25.42.0.0/15,25.44.0.0/14,25.48.0.0/12,25.132.0.0/14,25.136.0.0/14,25.140.0.0/15,25.240.0.0/14,25.250.86.0/23,25.250.88.0/21,25.250.96.0/19,25.250.128.0/17,25.254.9.0/24,25.254.10.0/23,25.254.12.0/22,25.254.32.0/19,26.0.0.0/7,28.0.0.0/6,32.0.0.0/5,40.0.0.0/10,40.64.0.0/15,40.66.0.0/17,40.67.0.0/16,40.68.0.0/14,40.72.0.0/13,40.80.0.0/12,40.96.0.0/11,40.128.0.0/9,41.0.0.0/8,42.0.0.0/7,44.0.0.0/6,48.0.0.0/6,52.0.0.0/9,52.128.0.0/14,52.136.0.0/13,52.144.0.0/16,52.146.0.0/15,52.148.0.0/14,52.152.0.0/13,52.160.0.0/11,52.192.0.0/10,53.0.0.0/8,54.0.0.0/7,56.0.0.0/5,64.0.0.0/3,96.0.0.0/6,100.0.0.0/10,100.128.0.0/9,101.0.0.0/8,102.0.0.0/7,104.0.0.0/9,104.128.0.0/10,104.192.0.0/12,104.208.0.0/14,104.212.0.0/19,104.212.32.0/22,104.212.40.0/21,104.212.48.0/22,104.212.56.0/21,104.212.64.0/18,104.212.128.0/17,104.213.0.0/16,104.214.0.0/15,104.216.0.0/13,104.224.0.0/11,105.0.0.0/8,106.0.0.0/7,108.0.0.0/6,112.0.0.0/5,120.0.0.0/6,124.0.0.0/7,126.0.0.0/8,128.0.0.0/8,129.0.0.0/10,129.64.0.0/13,129.72.0.0/15,129.74.0.0/16,129.76.0.0/14,129.80.0.0/12,129.96.0.0/11,129.128.0.0/9,130.0.0.0/7,132.0.0.0/7,134.0.0.0/9,134.128.0.0/11,134.160.0.0/12,134.176.0.0/16,134.178.0.0/15,134.180.0.0/14,134.184.0.0/13,134.192.0.0/10,135.0.0.0/8,136.0.0.0/7,138.0.0.0/9,138.128.0.0/10,138.192.0.0/14,138.197.0.0/16,138.198.0.0/15,138.200.0.0/13,138.208.0.0/12,138.224.0.0/11,139.0.0.0/8,140.0.0.0/8,141.0.0.0/9,141.128.0.0/10,141.192.0.0/11,141.224.0.0/12,141.240.0.0/13,141.248.0.0/15,141.250.0.0/16,141.252.0.0/14,142.0.0.0/7,144.0.0.0/7,146.0.0.0/9,146.128.0.0/12,146.144.0.0/15,146.146.0.0/16,146.148.0.0/14,146.152.0.0/13,146.160.0.0/11,146.192.0.0/10,147.0.0.0/8,148.0.0.0/6,152.0.0.0/5,160.0.0.0/5,168.0.0.0/8,169.0.0.0/9,169.128.0.0/10,169.192.0.0/11,169.224.0.0/12,169.240.0.0/13,169.248.0.0/14,169.252.0.0/15,169.255.0.0/16,170.0.0.0/7,172.0.0.0/12,172.32.0.0/11,172.64.0.0/10,172.128.0.0/9,173.0.0.0/8,174.0.0.0/7,176.0.0.0/4,192.0.0.0/23,192.0.3.0/24,192.0.4.0/22,192.0.8.0/21,192.0.16.0/20,192.0.32.0/19,192.0.64.0/18,192.0.128.0/17,192.1.0.0/16,192.2.0.0/15,192.4.0.0/14,192.8.0.0/13,192.16.0.0/12,192.33.0.0/16,192.34.0.0/15,192.36.0.0/14,192.40.0.0/13,192.48.0.0/12,192.64.0.0/11,192.96.0.0/14,192.100.0.0/18,192.100.64.0/19,192.100.96.0/22,192.100.100.0/23,192.100.104.0/21,192.100.112.0/20,192.100.128.0/17,192.101.0.0/16,192.102.0.0/15,192.104.0.0/13,192.112.0.0/12,192.128.0.0/11,192.160.0.0/13,192.169.0.0/16,192.170.0.0/15,192.172.0.0/14,192.176.0.0/12,192.192.0.0/10,193.0.0.0/8,194.0.0.0/7,196.0.0.0/7,198.0.0.0/12,198.16.0.0/15,198.20.0.0/14,198.24.0.0/13,198.32.0.0/11,198.64.0.0/10,198.128.0.0/9,199.0.0.0/8,200.0.0.0/5,208.0.0.0/4
