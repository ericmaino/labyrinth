nodes:
  - key: AzureBackbone/inbound
    routes: []
  - key: AzureBackbone/outbound
    routes:
      - destination: Internet
  - key: Internet
    endpoint: true
    routes:
      - destination: publicIp1/inbound
        constraints:
          destinationIp: 20.47.120.58
      - destination: publicIp2/inbound
        constraints:
          destinationIp: 20.80.145.57
  - key: nic1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/networkinterfaces/vm-a-01125/inbound
    routes:
      - destination: vm1
  - key: nic1/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/networkinterfaces/vm-a-01125/outbound
    routes:
      - destination: vnet1/router
  - key: nic2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/networkinterfaces/vm-b-01466/inbound
    routes:
      - destination: vm2
  - key: nic2/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/networkinterfaces/vm-b-01466/outbound
    routes:
      - destination: vnet2/router
  - key: nic3/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/networkinterfaces/vm-b-02487/inbound
    routes:
      - destination: vm3
  - key: nic3/outbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/networkinterfaces/vm-b-02487/outbound
    routes:
      - destination: vnet2/router
  - key: publicIp1/inbound
    routes:
      - destination: vnet1/router
        override:
          destinationIp: 192.168.20.4
  - key: publicIp1/outbound
    routes:
      - destination: Internet
        override:
          sourceIp: 20.47.120.58
  - key: publicIp2/inbound
    routes:
      - destination: vnet2/router
        override:
          destinationIp: 192.168.10.7
  - key: publicIp2/outbound
    routes:
      - destination: AzureBackbone/outbound
        override:
          sourceIp: 20.80.145.57
  - key: subnet1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/virtualnetworks/graph-test-a/subnets/subnet-a-20/inbound
    routes:
      - destination: nic1/inbound
        constraints:
          destinationIp: 192.168.20.4
  - key: subnet2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/virtualnetworks/graph-test-b/subnets/subnet-b/inbound
    routes:
      - destination: nic2/inbound
        constraints:
          destinationIp: 192.168.10.4
      - destination: nic3/inbound
        constraints:
          destinationIp: 192.168.10.7
  - key: vm1
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.compute/virtualmachines/vm-a-01
    endpoint: true
    routes:
      - destination: nic1/outbound
        constraints:
          sourceIp: 192.168.20.4
  - key: vm2
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.compute/virtualmachines/vm-b-01
    endpoint: true
    routes:
      - destination: nic2/outbound
        constraints:
          sourceIp: 192.168.10.4
  - key: vm3
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.compute/virtualmachines/vm-b-02
    endpoint: true
    routes:
      - destination: nic3/outbound
        constraints:
          sourceIp: 192.168.10.7
  - key: vnet1/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/virtualnetworks/graph-test-a
    routes:
      - destination: subnet1/inbound
        constraints:
          destinationIp: 192.168.20.0/28
  - key: vnet1/router
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/virtualnetworks/graph-test-a
    range:
      sourceIp: 192.168.20.0/24
    routes:
      - destination: publicIp1/outbound
        constraints:
          sourceIp: 192.168.20.4
      - destination: AzureBackbone/outbound
        constraints:
          destinationIp: except 192.168.20.0/24
      - destination: vnet1/inbound
  - key: vnet2/inbound
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/virtualnetworks/graph-test-b
    routes:
      - destination: subnet2/inbound
        constraints:
          destinationIp: 192.168.10.0/28
  - key: vnet2/router
    name: >-
      /subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/graph-test/providers/microsoft.network/virtualnetworks/graph-test-b
    range:
      sourceIp: 192.168.10.0/24
    routes:
      - destination: publicIp2/outbound
        constraints:
          sourceIp: 192.168.10.7
      - destination: AzureBackbone/outbound
        constraints:
          destinationIp: except 192.168.10.0/24
      - destination: vnet2/inbound
symbols:
  - dimension: ip
    symbol: AzureLoadBalancer
    range: 168.63.129.16
  - dimension: protocol
    symbol: Udp
    range: udp
  - dimension: protocol
    symbol: UDP
    range: udp
  - dimension: protocol
    symbol: Tcp
    range: tcp
  - dimension: protocol
    symbol: TCP
    range: tcp
  - dimension: ip
    symbol: vnet1
    range: 192.168.20.0/24
  - dimension: ip
    symbol: vnet2
    range: 192.168.10.0/24
  - dimension: ip
    symbol: Internet
    range: 'except 192.168.20.0/24,192.168.10.0/24'
